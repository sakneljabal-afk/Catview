<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù„Ø¹Ø¨Ø© Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø²Ù…Ù† - Ø£Ø³Ø¦Ù„Ø© ÙÙŠ ØµÙ†Ø§Ø¯ÙŠÙ‚</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background: linear-gradient(to bottom, #87CEEB, #E0F6FF);
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            color: #333;
        }
        
        #game-container {
            flex: 1;
            position: relative;
            overflow: hidden;
            margin: 0 auto;
            max-width: 1000px;
        }
        
        #game-canvas {
            display: block;
            background-color: #87CEEB;
            width: 100%;
            height: 100%;
        }
        
        #hud {
            position: absolute;
            top: 15px;
            width: 100%;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            z-index: 10;
            font-size: 20px;
            font-weight: bold;
            text-shadow: 1px 1px 2px white;
        }
        
        #score {
            background-color: rgba(255, 255, 255, 0.7);
            padding: 8px 15px;
            border-radius: 10px;
            border: 2px solid #8B4513;
        }
        
        #lives {
            display: flex;
            gap: 8px;
            background-color: rgba(255, 255, 255, 0.7);
            padding: 8px 15px;
            border-radius: 10px;
            border: 2px solid #8B4513;
        }
        
        .heart {
            color: #FF4757;
            font-size: 24px;
        }
        
        #controls {
            position: absolute;
            bottom: 30px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 30px;
            z-index: 10;
        }
        
        .control-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            border: 3px solid white;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }
        
        #left-btn {
            margin-right: 20px;
        }
        
        #jump-btn {
            background-color: rgba(46, 204, 113, 0.8);
        }
        
        #attack-btn {
            background-color: rgba(231, 76, 60, 0.8);
        }
        
        #start-screen, #question-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #1a2980, #26d0ce);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
            text-align: center;
            padding: 20px;
        }
        
        #question-screen {
            background: linear-gradient(to bottom, #2c3e50, #3498db);
            display: none;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 20px;
            text-shadow: 3px 3px 5px rgba(0, 0, 0, 0.5);
            color: #FFD700;
        }
        
        h2 {
            font-size: 2rem;
            margin-bottom: 30px;
            color: #FFD700;
        }
        
        p {
            font-size: 1.4rem;
            margin-bottom: 30px;
            max-width: 800px;
            line-height: 1.6;
        }
        
        .character-select {
            display: flex;
            gap: 30px;
            margin: 30px 0;
        }
        
        .character {
            width: 100px;
            height: 120px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .character:hover, .character.selected {
            border-color: #FFD700;
            background-color: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }
        
        .character-icon {
            font-size: 50px;
            margin-bottom: 10px;
        }
        
        .character-name {
            font-size: 1rem;
        }
        
        .btn {
            background-color: #FFD700;
            color: #333;
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 20px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .btn:hover {
            background-color: #FFC300;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        .question {
            font-size: 1.8rem;
            margin-bottom: 30px;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            max-width: 800px;
        }
        
        .answers {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            max-width: 800px;
            margin-bottom: 30px;
        }
        
        .answer-btn {
            background-color: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: 20px;
            font-size: 1.2rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .answer-btn:hover {
            background-color: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        #result-message {
            font-size: 2rem;
            margin: 20px 0;
            font-weight: bold;
            min-height: 50px;
        }
        
        .correct {
            color: #2ecc71;
        }
        
        .wrong {
            color: #e74c3c;
        }
        
        #instructions {
            margin-top: 30px;
            font-size: 1.2rem;
            background-color: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            max-width: 800px;
        }
        
        @media (max-width: 768px) {
            .control-btn {
                width: 70px;
                height: 70px;
                font-size: 30px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            h2 {
                font-size: 1.8rem;
            }
            
            .question {
                font-size: 1.5rem;
            }
            
            .answers {
                grid-template-columns: 1fr;
            }
            
            .character-select {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <canvas id="game-canvas"></canvas>
        
        <div id="hud">
            <div id="score">Ø§Ù„Ù†Ù‚Ø§Ø·: 0</div>
            <div id="lives">
                <span class="heart">â¤ï¸</span>
                <span class="heart">â¤ï¸</span>
                <span class="heart">â¤ï¸</span>
            </div>
        </div>
        
        <div id="controls">
            <div style="display: flex;">
                <div id="left-btn" class="control-btn">â¬…ï¸</div>
                <div id="right-btn" class="control-btn">â¡ï¸</div>
            </div>
            <div style="display: flex;">
                <div id="jump-btn" class="control-btn">â¬†ï¸</div>
                <div id="attack-btn" class="control-btn">âš”ï¸</div>
            </div>
        </div>
        
        <div id="start-screen">
            <h1>Ù„Ø¹Ø¨Ø© Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø²Ù…Ù†</h1>
            <p>Ø§Ù‡Ù„Ø§ Ø¨Ùƒ ÙÙŠ Ù„Ø¹Ø¨Ø© ØªØ¬Ù…Ø¹ Ø¨ÙŠÙ† Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø²Ù…Ù†! Ø§Ø¬Ù…Ø¹ Ø§Ù„Ù†Ù‚Ø§Ø· Ø¨ØªØ­Ø·ÙŠÙ… Ø§Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚ ÙˆØ£Ø¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù„ØªØªÙ‚Ø¯Ù… ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©</p>
            
            <div class="character-select">
                <div class="character selected" data-character="mario">
                    <div class="character-icon">ğŸ‘¨</div>
                    <div class="character-name">Ù…Ø§Ø±ÙŠÙˆ</div>
                </div>
                <div class="character" data-character="aladdin">
                    <div class="character-icon">ğŸ§</div>
                    <div class="character-name">Ø¹Ù„Ø§Ø¡ Ø§Ù„Ø¯ÙŠÙ†</div>
                </div>
                <div class="character" data-character="rambo">
                    <div class="character-icon">ğŸ’ª</div>
                    <div class="character-name">Ø±Ø§Ù…Ø¨Ùˆ</div>
                </div>
            </div>
            
            <button id="start-btn" class="btn">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
            
            <div id="instructions">
                <strong>ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨:</strong><br>
                - Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø±ÙƒØ© Ù„Ù„ØªØ­Ø±Ùƒ ÙŠÙ…ÙŠÙ†Ù‹Ø§ ÙˆÙŠØ³Ø§Ø±Ù‹Ø§<br>
                - Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± Ø§Ù„Ù‚ÙØ² Ù„Ù„Ù‚ÙØ² ÙÙˆÙ‚ Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª<br>
                - Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± Ø§Ù„Ù‡Ø¬ÙˆÙ… Ù„ØªØ­Ø·ÙŠÙ… Ø§Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚<br>
                - Ø¹Ù†Ø¯Ù…Ø§ ØªØ­Ø·Ù… ØµÙ†Ø¯ÙˆÙ‚Ù‹Ø§ØŒ Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø³Ø¤Ø§Ù„ ÙŠØ¬Ø¨ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„ÙŠÙ‡
            </div>
        </div>
        
        <div id="question-screen">
            <h2>Ø³Ø¤Ø§Ù„!</h2>
            <div id="question" class="question"></div>
            <div id="answers" class="answers"></div>
            <div id="result-message"></div>
            <button id="continue-btn" class="btn" style="display: none;">Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
        </div>
    </div>

    <script>
        // Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const startScreen = document.getElementById('start-screen');
        const questionScreen = document.getElementById('question-screen');
        const scoreElement = document.getElementById('score');
        const livesElement = document.getElementById('lives');
        const questionElement = document.getElementById('question');
        const answersElement = document.getElementById('answers');
        const resultMessage = document.getElementById('result-message');
        const continueBtn = document.getElementById('continue-btn');
        
        // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
        const leftBtn = document.getElementById('left-btn');
        const rightBtn = document.getElementById('right-btn');
        const jumpBtn = document.getElementById('jump-btn');
        const attackBtn = document.getElementById('attack-btn');
        const startBtn = document.getElementById('start-btn');
        
        // Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
        function resizeCanvas() {
            canvas.width = canvas.parentElement.clientWidth;
            canvas.height = canvas.parentElement.clientHeight;
        }
        
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        
        // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ø®ØµÙŠØ©
        let selectedCharacter = 'mario';
        document.querySelectorAll('.character').forEach(character => {
            character.addEventListener('click', () => {
                document.querySelectorAll('.character').forEach(c => c.classList.remove('selected'));
                character.classList.add('selected');
                selectedCharacter = character.getAttribute('data-character');
            });
        });
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
        let gameRunning = false;
        let score = 0;
        let lives = 3;
        let player = {};
        let boxes = [];
        let platforms = [];
        let keys = {};
        let currentQuestion = null;
        let questionActive = false;
        
        // Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯)
        const questions = [
            {
                question: "Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ù…ØµØ±ØŸ",
                answers: ["Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©", "Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©", "Ø§Ù„Ø¬ÙŠØ²Ø©", "Ø£Ø³ÙˆØ§Ù†"],
                correct: 0
            },
            {
                question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø£ÙˆØ¬Ù‡ Ø§Ù„Ù…ÙƒØ¹Ø¨ØŸ",
                answers: ["4", "6", "8", "12"],
                correct: 1
            },
            {
                question: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ø£Ø­Ù…Ø±ØŸ",
                answers: ["Ø§Ù„Ø£Ø±Ø¶", "Ø§Ù„Ù…Ø±ÙŠØ®", "Ø§Ù„Ù…Ø´ØªØ±ÙŠ", "Ø§Ù„Ø²Ù‡Ø±Ø©"],
                correct: 1
            },
            {
                question: "Ù…Ø§ Ù‡ÙŠ Ø£ÙƒØ¨Ø± Ù‚Ø§Ø±Ø© ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ",
                answers: ["Ø£ÙØ±ÙŠÙ‚ÙŠØ§", "Ø£ÙˆØ±ÙˆØ¨Ø§", "Ø¢Ø³ÙŠØ§", "Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©"],
                correct: 2
            },
            {
                question: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ Ø§Ù„Ø°ÙŠ Ø±Ù…Ø²Ù‡ OØŸ",
                answers: ["Ø°Ù‡Ø¨", "Ø£ÙƒØ³Ø¬ÙŠÙ†", "Ø­Ø¯ÙŠØ¯", "ÙØ¶Ø©"],
                correct: 1
            }
        ];
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
        function initGame() {
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨
            player = {
                x: canvas.width * 0.1,
                y: canvas.height * 0.7,
                width: 40,
                height: 60,
                velocityX: 0,
                velocityY: 0,
                speed: 5,
                jumpPower: 15,
                isJumping: false,
                isAttacking: false,
                attackTime: 0,
                character: selectedCharacter,
                color: selectedCharacter === 'mario' ? '#E52521' : 
                       selectedCharacter === 'aladdin' ? '#F9C80E' : '#8B4513'
            };
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚
            boxes = [];
            for (let i = 0; i < 8; i++) {
                boxes.push({
                    x: canvas.width * 0.3 + (i % 4) * 90,
                    y: canvas.height * 0.5 - Math.floor(i / 4) * 100,
                    width: 60,
                    height: 60,
                    broken: false,
                    type: Math.floor(Math.random() * 3) // 0: Ø³Ø¤Ø§Ù„ØŒ 1: Ù†Ù‚Ø§Ø·ØŒ 2: Ø­ÙŠØ§Ø©
                });
            }
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù†ØµØ§Øª
            platforms = [
                {x: 0, y: canvas.height * 0.8, width: canvas.width, height: 20},
                {x: canvas.width * 0.2, y: canvas.height * 0.6, width: 150, height: 20},
                {x: canvas.width * 0.6, y: canvas.height * 0.5, width: 150, height: 20},
                {x: canvas.width * 0.4, y: canvas.height * 0.4, width: 150, height: 20}
            ];
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ­ÙƒÙ…
            keys = {
                left: false,
                right: false,
                jump: false,
                attack: false
            };
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆØ§Ù„Ø­ÙŠØ§Ø©
            score = 0;
            lives = 3;
            updateHUD();
            
            // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø¡
            startScreen.style.display = 'none';
            questionScreen.style.display = 'none';
            gameRunning = true;
            
            // Ø¨Ø¯Ø¡ Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            requestAnimationFrame(gameLoop);
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
        function updateHUD() {
            scoreElement.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}`;
            
            const hearts = livesElement.querySelectorAll('.heart');
            hearts.forEach((heart, index) => {
                heart.style.opacity = index < lives ? '1' : '0.3';
            });
        }
        
        // Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        leftBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys.left = true;
        });
        
        leftBtn.addEventListener('touchend', (e) => {
            e.preventDefault();
            keys.left = false;
        });
        
        rightBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys.right = true;
        });
        
        rightBtn.addEventListener('touchend', (e) => {
            e.preventDefault();
            keys.right = false;
        });
        
        jumpBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (!player.isJumping) {
                player.velocityY = -player.jumpPower;
                player.isJumping = true;
            }
        });
        
        attackBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (!player.isAttacking) {
                player.isAttacking = true;
                player.attackTime = 15;
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ ØµÙ†Ø§Ø¯ÙŠÙ‚ Ù„Ù„ØªØ­Ø·ÙŠÙ…
                for (let box of boxes) {
                    if (!box.broken) {
                        const playerCenterX = player.x + player.width / 2;
                        const playerCenterY = player.y + player.height / 2;
                        const boxCenterX = box.x + box.width / 2;
                        const boxCenterY = box.y + box.height / 2;
                        
                        const distance = Math.sqrt(
                            Math.pow(playerCenterX - boxCenterX, 2) + 
                            Math.pow(playerCenterY - boxCenterY, 2)
                        );
                        
                        if (distance < 80) {
                            // ØªØ­Ø·ÙŠÙ… Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚
                            box.broken = true;
                            
                            if (box.type === 0) { // ØµÙ†Ø¯ÙˆÙ‚ Ø³Ø¤Ø§Ù„
                                showQuestion();
                            } else if (box.type === 1) { // ØµÙ†Ø¯ÙˆÙ‚ Ù†Ù‚Ø§Ø·
                                score += 50;
                                updateHUD();
                            } else if (box.type === 2) { // ØµÙ†Ø¯ÙˆÙ‚ Ø­ÙŠØ§Ø©
                                lives = Math.min(3, lives + 1);
                                updateHUD();
                            }
                            break;
                        }
                    }
                }
            }
        });
        
        // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
        startBtn.addEventListener('click', initGame);
        
        // Ø¹Ø±Ø¶ Ø³Ø¤Ø§Ù„
        function showQuestion() {
            gameRunning = false;
            questionActive = true;
            
            // Ø§Ø®ØªÙŠØ§Ø± Ø³Ø¤Ø§Ù„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
            currentQuestion = questions[Math.floor(Math.random() * questions.length)];
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„
            questionElement.textContent = currentQuestion.question;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
            answersElement.innerHTML = '';
            currentQuestion.answers.forEach((answer, index) => {
                const button = document.createElement('div');
                button.className = 'answer-btn';
                button.textContent = answer;
                button.addEventListener('click', () => checkAnswer(index));
                answersElement.appendChild(button);
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„Ø³Ø¤Ø§Ù„
            questionScreen.style.display = 'flex';
            resultMessage.textContent = '';
            continueBtn.style.display = 'none';
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
        function checkAnswer(selectedIndex) {
            if (currentQuestion.correct === selectedIndex) {
                resultMessage.textContent = "Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! +100 Ù†Ù‚Ø·Ø©";
                resultMessage.className = "correct";
                score += 100;
                updateHUD();
            } else {
                resultMessage.textContent = "Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! -1 Ø­ÙŠØ§Ø©";
                resultMessage.className = "wrong";
                lives--;
                updateHUD();
                
                if (lives <= 0) {
                    resultMessage.textContent += " - Game Over!";
                    continueBtn.textContent = "Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©";
                }
            }
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©
            continueBtn.style.display = 'block';
        }
        
        // Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø¤Ø§Ù„
        continueBtn.addEventListener('click', () => {
            if (lives <= 0) {
                // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
                startScreen.style.display = 'flex';
                questionScreen.style.display = 'none';
                return;
            }
            
            questionScreen.style.display = 'none';
            questionActive = false;
            gameRunning = true;
            requestAnimationFrame(gameLoop);
        });
        
        // Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ø¹Ø¨Ø©
        function gameLoop() {
            if (!gameRunning) return;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„Ø§Ø¹Ø¨
            updatePlayer();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‡Ø¬ÙˆÙ…
            if (player.isAttacking) {
                player.attackTime--;
                if (player.attackTime <= 0) {
                    player.isAttacking = false;
                }
            }
            
            // Ø§Ù„Ù…Ø³Ø­ ÙˆØ§Ù„Ø±Ø³Ù…
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Ø±Ø³Ù… Ø§Ù„Ø®Ù„ÙÙŠØ©
            drawBackground();
            
            // Ø±Ø³Ù… Ø§Ù„Ù…Ù†ØµØ§Øª
            drawPlatforms();
            
            // Ø±Ø³Ù… Ø§Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚
            drawBoxes();
            
            // Ø±Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨
            drawPlayer();
            
            // Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙÙŠ Ø§Ù„Ø­Ù„Ù‚Ø©
            requestAnimationFrame(gameLoop);
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨
        function updatePlayer() {
            // Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø£ÙÙ‚ÙŠØ©
            player.velocityX = 0;
            if (keys.left) player.velocityX = -player.speed;
            if (keys.right) player.velocityX = player.speed;
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©
            player.velocityY += 0.8;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆØ¶Ø¹
            player.x += player.velocityX;
            player.y += player.velocityY;
            
            // Ù…Ù†Ø¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø´Ø§Ø´Ø©
            if (player.x < 0) player.x = 0;
            if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù… Ù…Ø¹ Ø§Ù„Ù…Ù†ØµØ§Øª
            player.isJumping = true;
            for (let platform of platforms) {
                if (player.x < platform.x + platform.width &&
                    player.x + player.width > platform.x &&
                    player.y + player.height > platform.y &&
                    player.y + player.height < platform.y + 30 &&
                    player.velocityY > 0) {
                    
                    player.y = platform.y - player.height;
                    player.velocityY = 0;
                    player.isJumping = false;
                }
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆÙ‚ÙˆØ¹ Ø®Ø§Ø±Ø¬ Ø§Ù„Ø´Ø§Ø´Ø©
            if (player.y > canvas.height) {
                lives--;
                updateHUD();
                
                if (lives <= 0) {
                    gameOver();
                } else {
                    player.x = canvas.width * 0.1;
                    player.y = canvas.height * 0.7;
                    player.velocityX = 0;
                    player.velocityY = 0;
                }
            }
        }
        
        // Ø±Ø³Ù… Ø§Ù„Ø®Ù„ÙÙŠØ©
        function drawBackground() {
            // Ø§Ù„Ø³Ù…Ø§Ø¡
            ctx.fillStyle = '#87CEEB';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Ø§Ù„Ø³Ø­Ø¨
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(canvas.width * 0.2, canvas.height * 0.2, 30, 0, Math.PI * 2);
            ctx.arc(canvas.width * 0.25, canvas.height * 0.15, 40, 0, Math.PI * 2);
            ctx.arc(canvas.width * 0.3, canvas.height * 0.2, 30, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.beginPath();
            ctx.arc(canvas.width * 0.7, canvas.height * 0.3, 30, 0, Math.PI * 2);
            ctx.arc(canvas.width * 0.75, canvas.height * 0.25, 40, 0, Math.PI * 2);
            ctx.arc(canvas.width * 0.8, canvas.height * 0.3, 30, 0, Math.PI * 2);
            ctx.fill();
            
            // Ø§Ù„Ø£Ø±Ø¶
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(0, canvas.height * 0.8, canvas.width, canvas.height * 0.2);
            
            // Ø§Ù„Ø¹Ø´Ø¨
            ctx.fillStyle = '#2E8B57';
            ctx.fillRect(0, canvas.height * 0.8, canvas.width, 10);
        }
        
        // Ø±Ø³Ù… Ø§Ù„Ù…Ù†ØµØ§Øª
        function drawPlatforms() {
            ctx.fillStyle = '#8B4513';
            platforms.forEach(platform => {
                ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
            });
        }
        
        // Ø±Ø³Ù… Ø§Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚
        function drawBoxes() {
            boxes.forEach(box => {
                if (box.broken) {
                    // Ø±Ø³Ù… Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù…Ø­Ø·Ù…
                    ctx.fillStyle = '#654321';
                    ctx.fillRect(box.x, box.y, box.width, box.height);
                    
                    // Ø±Ø³Ù… Ø´Ø±Ø® ÙÙŠ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚
                    ctx.strokeStyle = '#8B4513';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(box.x + 10, box.y + 10);
                    ctx.lineTo(box.x + box.width - 10, box.y + box.height - 10);
                    ctx.stroke();
                    
                    ctx.beginPath();
                    ctx.moveTo(box.x + box.width - 10, box.y + 10);
                    ctx.lineTo(box.x + 10, box.y + box.height - 10);
                    ctx.stroke();
                } else {
                    // Ø±Ø³Ù… Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø³Ù„ÙŠÙ…
                    ctx.fillStyle = box.type === 0 ? '#FFD700' : 
                                    box.type === 1 ? '#1E90FF' : '#32CD32';
                    ctx.fillRect(box.x, box.y, box.width, box.height);
                    
                    // Ø±Ø³Ù… Ø­Ø¯ÙˆØ¯ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚
                    ctx.strokeStyle = '#8B4513';
                    ctx.lineWidth = 2;
                    ctx.strokeRect(box.x, box.y, box.width, box.height);
                    
                    // Ø±Ø³Ù… Ø±Ù…Ø² Ø¹Ù„Ù‰ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚
                    ctx.fillStyle = 'white';
                    ctx.font = '24px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    
                    const symbol = box.type === 0 ? '?' : 
                                   box.type === 1 ? '50' : 'â™¥';
                    ctx.fillText(symbol, box.x + box.width/2, box.y + box.height/2);
                }
            });
        }
        
        // Ø±Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨
        function drawPlayer() {
            // Ø¬Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.width, player.height);
            
            // Ø±Ø£Ø³ Ø§Ù„Ù„Ø§Ø¹Ø¨
            ctx.fillStyle = '#FFE4C4';
            ctx.beginPath();
            ctx.arc(player.x + player.width/2, player.y + 15, 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Ø¹ÙŠÙˆÙ† Ø§Ù„Ù„Ø§Ø¹Ø¨
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(player.x + player.width/2 - 5, player.y + 12, 3, 0, Math.PI * 2);
            ctx.arc(player.x + player.width/2 + 5, player.y + 12, 3, 0, Math.PI * 2);
            ctx.fill();
            
            // ÙÙ… Ø§Ù„Ù„Ø§Ø¹Ø¨
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.arc(player.x + player.width/2, player.y + 18, 5, 0, Math.PI);
            ctx.stroke();
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† ÙŠÙ‡Ø§Ø¬Ù…ØŒ Ø±Ø³Ù… Ø³ÙŠÙ
            if (player.isAttacking) {
                ctx.strokeStyle = '#C0C0C0';
                ctx.lineWidth = 4;
                ctx.beginPath();
                ctx.moveTo(player.x + player.width, player.y + player.height/2);
                ctx.lineTo(player.x + player.width + 40, player.y + player.height/2 - 20);
                ctx.stroke();
                
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.arc(player.x + player.width + 40, player.y + player.height/2 - 20, 8, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // Ø§Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠØ© ØªØ­Øª Ø§Ù„Ù„Ø§Ø¹Ø¨
            ctx.fillStyle = 'black';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            const characterName = player.character === 'mario' ? 'Ù…Ø§Ø±ÙŠÙˆ' : 
                                 player.character === 'aladdin' ? 'Ø¹Ù„Ø§Ø¡ Ø§Ù„Ø¯ÙŠÙ†' : 'Ø±Ø§Ù…Ø¨Ùˆ';
            ctx.fillText(characterName, player.x + player.width/2, player.y + player.height + 15);
        }
        
        // Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø©
        function gameOver() {
            gameRunning = false;
            
            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø©
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = 'white';
            ctx.font = 'bold 48px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©!', canvas.width/2, canvas.height/2 - 50);
            
            ctx.font = '36px Arial';
            ctx.fillText(`Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${score}`, canvas.width/2, canvas.height/2 + 20);
            
            ctx.font = '24px Arial';
            ctx.fillText('Ø§Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ù„Ø¹ÙˆØ¯Ø©', canvas.width/2, canvas.height/2 + 80);
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù„Ù…Ø³
            canvas.addEventListener('click', () => {
                startScreen.style.display = 'flex';
            }, { once: true });
        }
        
        // ØªÙ‡ÙŠØ¦Ø© Ø£ÙˆÙ„ÙŠØ©
        updateHUD();
    </script>
</body>
</html>