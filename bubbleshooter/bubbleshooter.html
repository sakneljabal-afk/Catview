<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø¯ÙØ¹ ÙˆØ§Ù„ÙÙ‚Ø§Ø¹Ø§Øª</title>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.min.js"></script>

<style>
  /* === ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© === */
  body {
    margin: 0;
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    touch-action: none; 
    overflow: hidden; 
    height: 100vh;
    display: flex;
    flex-direction: column;
  }

  /* === Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© (Ø§Ù„Ø³Ø¤Ø§Ù„) === */
  header {
    background: #2c3e50; 
    color: #fff;
    text-align: center;
    padding: 10px;
    height: 20vh; /* ğŸ’¥ Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ù„Ø¥ØªØ§Ø­Ø© Ù…Ø³Ø§Ø­Ø© Ø£ÙƒØ¨Ø± Ù„Ù„Ù†Øµ */
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    justify-content: center;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    z-index: 10;
  }

  header h3 {
    margin: 0 0 5px 0;
    font-size: clamp(1rem, 4.5vw, 1.6rem); /* ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø· Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
    color: #ffd700;
  }

  .answers {
    display: block; /* ğŸ’¥ Ø¬Ø¹Ù„ ÙƒÙ„ Ø¥Ø¬Ø§Ø¨Ø© ÙÙŠ Ø³Ø·Ø± Ù…Ù†ÙØµÙ„ */
    text-align: right; /* Ù…Ø­Ø§Ø°Ø§Ø© Ø§Ù„Ù†Øµ Ù„Ù„ÙŠÙ…ÙŠÙ† */
    padding: 5px 15px; /* Ù‡ÙˆØ§Ù…Ø´ Ø¯Ø§Ø®Ù„ÙŠØ© */
  }
  
  .answers span {
    display: block; /* ÙƒÙ„ Span ÙŠØ¸Ù‡Ø± ÙÙŠ Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯ */
    font-size: clamp(0.9rem, 3.8vw, 1.3rem); /* Ø®Ø· Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    margin: 3px 0;
    padding: 2px 0;
    border-bottom: 1px dashed rgba(255,255,255,0.2);
  }
  
  .answers span:last-child {
      border-bottom: none;
  }

  /* === Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© === */
  main {
    flex: 1; 
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
  }

  /* Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ Ù„Ù„Ø¹Ø¨Ø© (ØªÙ… ØªØµØºÙŠØ± Ø§Ø±ØªÙØ§Ø¹Ù‡ Ù„Ø§Ø³ØªÙŠØ¹Ø§Ø¨ Ø§Ù„Ù€ header Ø§Ù„Ø£ÙƒØ¨Ø±) */
  #game-frame {
    width: 90vw; 
    height: 70vh; /* ğŸ’¥ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ */
    max-width: 600px; 
    background: #f0faff; 
    border: 8px solid #34495e; 
    border-radius: 20px;
    overflow: hidden;
    position: relative;
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
  }

  #game-container {
    width: 100%;
    height: 100%;
  }

  /* === Ù…Ø¤Ø«Ø±Ø§Øª Ø§Ù„Ø®Ø·Ø£ === */
  #wrongFlash {
    position: fixed;
    inset: 0;
    background: rgba(255, 0, 0, 0);
    pointer-events: none;
    transition: background 0.2s;
    z-index: 999;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø®Ø·Ø£ Ø§Ù„ÙƒØ¨ÙŠØ±Ø© */
  #errorMark {
    font-size: 8rem;
    color: white;
    background: rgba(255, 0, 0, 0.8);
    width: 150px;
    height: 150px;
    border-radius: 50%;
    display: none; 
    justify-content: center;
    align-items: center;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    border: 5px solid white;
  }

</style>
</head>

<body>

<header id="questionHeader"></header>

<main>
  <section id="game-frame">
    <div id="game-container"></div>
  </section>
</main>

<div id="wrongFlash">
  <div id="errorMark">âœ–</div>
</div>

<script>
/* ======================
Â  Â 1. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ù„Ø£Ø³Ø¦Ù„Ø©)
====================== */
const QUESTIONS = [
Â  { q:"Ù…Ø§ Ù‡Ùˆ Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ø£Ø­Ù…Ø±ØŸ", o:["Ù‡Ù„Â  Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù Ù…Ù† Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙƒÙ…Ø§ Ù†Ø±Ø§Ù‡ ÙÙˆÙ‚ Ù‡Ùˆ ÙƒÙˆÙƒØ¨ Ø§Ù„Ø²Ù‡Ø±Ø©","Ù‡Ù„Â  Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù Ù…Ù† Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙƒÙ…Ø§ Ù†Ø±Ø§Ù‡ ÙÙˆÙ‚ Ù‡Ùˆ ÙƒÙˆÙƒØ¨ Ø§Ù„Ù…Ø±ÙŠØ®","Ù‡Ù„Â  Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù Ù…Ù† Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙƒÙ…Ø§ Ù†Ø±Ø§Ù‡ ÙÙˆÙ‚ Ù‡Ùˆ ÙƒÙˆÙƒØ¨ Ø§Ù„Ù…Ø´ØªØ±ÙŠ"], a:1 },
Â { q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø±Ø¬Ù„ Ø§Ù„Ù‚Ø·ØŸ", o:["2","4","6"], a:1 },
Â { q:"Ù†Ø§ØªØ¬ 5 + 5ØŸ", o:["9","10","11"], a:1 },
Â { q:"Ø¹Ø§ØµÙ…Ø© Ù…ØµØ±ØŸ", o:["Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©","Ø§Ù„Ø§Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©","Ø£Ø³ÙˆØ§Ù†"], a:0 }
];

/* ======================
Â  Â 2. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø© (Phaser)
====================== */
const config = {
Â type: Phaser.AUTO,
Â parent: 'game-container', 
Â width: 600,Â  
Â height: 800, 
Â scale: {
Â  Â mode: Phaser.Scale.FIT, 
Â  Â autoCenter: Phaser.Scale.CENTER_BOTH
Â },
Â physics: {
Â  Â default: 'arcade',
Â  Â arcade: {
Â  Â  Â gravity: { y: 0 },
Â  Â  Â debug: false
Â  Â }
Â },
Â scene: { preload, create, update }
};

const game = new Phaser.Game(config);

/* ======================
Â  Â 3. Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
====================== */
let cannon, bubbles, arrow, invisibleWall;
let currentQ = 0;
let canShoot = true;
let isAiming = false;
let missedShots = 0;

const BUBBLE_IMG_SIZE = 300; 

/* ======================
Â  Â 4. Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Preload)
====================== */
function preload(){
Â this.load.image('cannon','assets/cannon.png');
Â this.load.image('shoot','assets/shoot.png');
Â this.load.image('bubble1','assets/bubble1.png');
Â this.load.image('bubble2','assets/bubble2.png');
Â this.load.image('bubble3','assets/bubble3.png');
Â this.load.audio('correct','assets/correct.mp3');
Â this.load.audio('wrong','assets/wrong.mp3');
}

/* ======================
Â  Â 5. Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ (Create)
====================== */
function create(){
Â const width = this.scale.width;
Â const height = this.scale.height;

Â this.correctSound = this.sound.add('correct');
Â this.wrongSound = this.sound.add('wrong');

Â this.physics.world.setBounds(0, 0, width, height);

Â invisibleWall = this.add.rectangle(width/2, height * 0.55, width, 20, 0x000000, 0);
Â this.physics.add.existing(invisibleWall, true);

Â const cannonHeight = height * 0.10;Â 
Â const cannonScale = cannonHeight / 300; 

Â cannon = this.add.sprite(width/2, height * 0.90, 'cannon')
Â  Â .setScale(cannonScale)
Â  Â .setDepth(1); 

Â bubbles = this.physics.add.group({
Â  Â collideWorldBounds: true,
Â  Â bounceX: 1,
Â  Â bounceY: 1
Â });
Â this.physics.add.collider(bubbles, invisibleWall);

Â arrow = this.add.text(cannon.x, cannon.y - (cannon.displayHeight), 'â¬†ï¸', {
Â  Â fontSize: '28px',
Â  Â fontFamily: 'Arial'
Â }).setOrigin(0.5);

Â this.input.on('pointermove', (pointer) => {
Â  Â let xPos = pointer.x;
Â  Â cannon.x = Phaser.Math.Clamp(xPos, width * 0.1, width * 0.9);
Â  Â arrow.x = cannon.x;
Â });

Â this.input.on('pointerdown', () => {
Â  Â if (!isAiming) { isAiming = true; return; }
Â  Â if (canShoot) fire(this);
Â });

Â showQuestion(this);
}

/* ======================
Â  Â 6. Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªÙ…Ø± (Update)
====================== */
function update() {
Â  bubbles.children.iterate((b) => {
Â  Â  if (b) b.rotation += 0.005;
Â  });
}

/* ======================
Â  Â 7. Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¥Ø·Ù„Ø§Ù‚ (Fire)
====================== */
function fire(scene){
Â canShoot = false;
Â isAiming = false;
Â arrow.setVisible(false);

Â const width = scene.scale.width;
Â const shotScale = (width * 0.12) / 300;Â 

Â const shot = scene.physics.add.sprite(
Â  Â cannon.x,
Â  Â cannon.y - cannon.displayHeight/1.5,
Â  Â 'shoot'
Â ).setScale(shotScale);

Â shot.setVelocityY(-800);Â 

Â scene.physics.add.overlap(shot, bubbles, (s, b) => {
Â  Â s.destroy();
Â  Â missedShots = 0;
Â  Â bubbleHit(scene, b);
Â });

Â shot.setCollideWorldBounds(true);
Â shot.body.onWorldBounds = true;

Â shot.body.world.on('worldbounds', (body) => {
Â  Â if (body.gameObject === shot) {
Â  Â  Â shot.destroy();
Â  Â  Â missedShots++;
Â  Â  Â if (missedShots >= 2) {
Â  Â  Â  Â missedShots = 0;
Â  Â  Â  Â showQuestion(scene); 
Â  Â  Â }
Â  Â }
Â });

Â scene.time.delayedCall(1200, () => { if(shot.active) shot.destroy(); });
Â 
Â scene.time.delayedCall(800, () => {
Â  Â canShoot = true;
Â  Â arrow.setVisible(true);
Â });
}

/* ======================
Â  Â 8. Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¥ØµØ§Ø¨Ø© (Hit)
====================== */
function bubbleHit(scene, bubble){
Â const correct = bubble.getData('correct');
Â bubble.destroy();

Â if(correct){
Â  Â scene.correctSound.play();
Â  Â scene.time.delayedCall(500, () => {
Â  Â  Â currentQ++;
Â  Â  Â showQuestion(scene);
Â  Â });
Â } else {
Â  Â const flash = document.getElementById('wrongFlash');
Â  Â const mark = document.getElementById('errorMark');
Â  Â 
Â  Â scene.wrongSound.play();
Â  Â 
Â  Â flash.style.background = 'rgba(255,0,0,0.4)';
Â  Â mark.style.display = 'flex'; 
Â  Â 
Â  Â setTimeout(() => {
Â  Â  Â flash.style.background = 'rgba(255,0,0,0)';
Â  Â  Â mark.style.display = 'none';
Â  Â }, 400); 

Â  Â scene.time.delayedCall(600, () => showQuestion(scene));
Â }
}

/* ======================
Â  Â 9. Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„ ÙˆØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙÙ‚Ø§Ø¹Ø§Øª
====================== */
function showQuestion(scene){
Â const q = QUESTIONS[currentQ];
Â 
Â if(!q){
Â  Â document.getElementById('questionHeader').innerHTML = '<h3 style="color:#4CAF50">ğŸ‰ Ø£Ø­Ø³Ù†Øª! Ø£Ù†Ù‡ÙŠØª Ø§Ù„Ù„Ø¹Ø¨Ø©</h3>';
Â  Â bubbles.clear(true, true);
Â  Â return;
Â }

Â document.getElementById('questionHeader').innerHTML = `
Â  Â <h3>${q.q}</h3>
Â  Â <div class="answers">
Â  Â  Â <span style="color:#81d4fa">1: ${q.o[0]}</span>
Â  Â  Â <span style="color:#a5d6a7">2: ${q.o[1]}</span>
Â  Â  Â <span style="color:#ffe082">3: ${q.o[2]}</span>
Â  Â </div>
Â `;

Â bubbles.clear(true, true);
Â 
Â const width = scene.scale.width;
Â const height = scene.scale.height;

Â // ğŸ’¥ ØªØµØºÙŠØ± Ø­Ø¬Ù… Ø§Ù„ÙÙ‚Ø§Ø¹Ø© Ù…Ù† 22% Ø¥Ù„Ù‰ 18% Ù…Ù† Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ
Â const bubbleTargetSize = width * 0.18; 
Â const bubbleScale = bubbleTargetSize / BUBBLE_IMG_SIZE;

Â const positions = [0.2, 0.5, 0.8]; 

Â for(let i=0; i<3; i++){
Â  Â const b = bubbles.create(
Â  Â  Â width * positions[i],
Â  Â  Â height * 0.3,Â 
Â  Â  Â 'bubble' + (i+1)
Â  Â ).setScale(bubbleScale);

Â  Â b.setCircle(130 * (bubbleScale / (width * 0.22 / BUBBLE_IMG_SIZE))); // ØªØ¹Ø¯ÙŠÙ„ Ù†ØµÙ Ø§Ù„Ù‚Ø·Ø± Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯

Â  Â b.setData('correct', i === q.a);
Â  Â 
Â  Â b.setVelocity(
Â  Â  Â Phaser.Math.Between(-50, 50),Â 
Â  Â  Â Phaser.Math.Between(-30, 30)
Â  Â );
Â  Â 
Â  Â b.setBounce(1);
Â  Â b.setCollideWorldBounds(true);
Â }
}
</script>
</body>
</html>
